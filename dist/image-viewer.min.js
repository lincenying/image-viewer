!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("vue")):"function"==typeof define&&define.amd?define(["vue"],t):"object"==typeof exports?exports.imageViewer=t(require("vue")):e.imageViewer=t(e.Vue)}(self,(function(e){return(()=>{"use strict";var t={196:(e,t,i)=>{i.d(t,{default:()=>m});var n=i(197),s=i.n(n);const a=s().prototype.$isServer;function r(e){let t=!1;return function(...i){t||(t=!0,window.requestAnimationFrame((n=>{e.apply(this,i),t=!1})))}}const o=!a&&document.addEventListener?function(e,t,i){e&&t&&i&&e.addEventListener(t,i,!1)}:function(e,t,i){e&&t&&i&&e.attachEvent("on"+t,i)},l=!a&&document.removeEventListener?function(e,t,i){e&&t&&e.removeEventListener(t,i,!1)}:function(e,t,i){e&&t&&e.detachEvent("on"+t,i)},c={CONTAIN:{name:"contain",icon:"imageviewer iv-full-screen"},ORIGINAL:{name:"original",icon:"imageviewer iv-c-scale-to-original"}},d=!s().prototype.$isServer&&window.navigator.userAgent.match(/firefox/i)?"DOMMouseScroll":"mousewheel",u=function(e,t,i,n,s,a,r,o){var l,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=[],c._compiled=!0),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(e,t){return l.call(t),d(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,l):[l]}return{exports:e,options:c}}({name:"imageViewer",props:{urlList:{type:Array,default:()=>[]},zIndex:{type:Number,default:2e3},onSwitch:{type:Function,default:()=>{}},onClose:{type:Function,default:()=>{}},initialIndex:{type:Number,default:0},closeOnClickMask:{type:Boolean,default:!1}},data(){return{index:this.initialIndex,isShow:!1,infinite:!0,loading:!1,mode:c.CONTAIN,transform:{scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}},computed:{isSingle(){return this.urlList.length<=1},isFirst(){return 0===this.index},isLast(){return this.index===this.urlList.length-1},currentImg(){return this.urlList[this.index]},imgStyle(){const{scale:e,deg:t,offsetX:i,offsetY:n,enableTransition:s}=this.transform,a={transform:`scale(${e}) rotate(${t}deg)`,transition:s?"transform .3s":"","margin-left":`${i}px`,"margin-top":`${n}px`};return this.mode===c.CONTAIN&&(a.maxWidth=a.maxHeight="100%"),a}},watch:{index:{handler:function(e){this.reset(),this.onSwitch(e)}},currentImg(e){this.$nextTick((e=>{this.$refs.img[0].complete||(this.loading=!0)}))}},methods:{onClickMask(){this.closeOnClickMask&&this.hide()},hide(){this.deviceSupportUninstall(),this.onClose()},deviceSupportInstall(){this._keyDownHandler=r((e=>{switch(e.keyCode){case 27:this.hide();break;case 32:this.toggleMode();break;case 37:this.prev();break;case 38:this.handleActions("zoomIn");break;case 39:this.next();break;case 40:this.handleActions("zoomOut")}})),this._mouseWheelHandler=r((e=>{(e.wheelDelta?e.wheelDelta:-e.detail)>0?this.handleActions("zoomIn",{zoomRate:.015,enableTransition:!1}):this.handleActions("zoomOut",{zoomRate:.015,enableTransition:!1})})),o(document,"keydown",this._keyDownHandler),o(document,d,this._mouseWheelHandler)},deviceSupportUninstall(){l(document,"keydown",this._keyDownHandler),l(document,d,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},handleImgLoad(e){this.loading=!1},handleImgError(e){this.loading=!1,e.target.alt="加载失败"},handleMouseDown(e){if(this.loading||0!==e.button)return;const{offsetX:t,offsetY:i}=this.transform,n=e.pageX,s=e.pageY;this._dragHandler=r((e=>{this.transform.offsetX=t+e.pageX-n,this.transform.offsetY=i+e.pageY-s})),o(document,"mousemove",this._dragHandler),o(document,"mouseup",(e=>{l(document,"mousemove",this._dragHandler)})),e.preventDefault()},reset(){this.transform={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode(){if(this.loading)return;const e=Object.keys(c),t=(Object.values(c).indexOf(this.mode)+1)%e.length;this.mode=c[e[t]],this.reset()},prev(){if(this.isFirst&&!this.infinite)return;const e=this.urlList.length;this.index=(this.index-1+e)%e},next(){if(this.isLast&&!this.infinite)return;const e=this.urlList.length;this.index=(this.index+1)%e},handleActions(e,t={}){if(this.loading)return;const{zoomRate:i,rotateDeg:n,enableTransition:s}={zoomRate:.2,rotateDeg:90,enableTransition:!0,...t},{transform:a}=this;switch(e){case"zoomOut":a.scale>.2&&(a.scale=parseFloat((a.scale-i).toFixed(3)));break;case"zoomIn":a.scale=parseFloat((a.scale+i).toFixed(3));break;case"clocelise":a.deg+=n;break;case"anticlocelise":a.deg-=n}a.enableTransition=s}},mounted(){this.deviceSupportInstall(),this.$refs["lcy-image-viewer__wrapper"].focus()}},(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"viewer-fade"}},[i("div",{ref:"lcy-image-viewer__wrapper",staticClass:"lcy-image-viewer__wrapper",style:{"z-index":e.zIndex},attrs:{tabindex:"-1"}},[i("div",{staticClass:"lcy-image-viewer__mask",on:{click:e.onClickMask}}),e._v(" "),i("span",{staticClass:"lcy-image-viewer__btn lcy-image-viewer__close",on:{click:e.hide}},[i("i",{staticClass:"imageviewer iv-circle-close"})]),e._v(" "),e.isSingle?e._e():[i("span",{staticClass:"lcy-image-viewer__btn lcy-image-viewer__prev",class:{"is-disabled":!e.infinite&&e.isFirst},on:{click:e.prev}},[i("i",{staticClass:"imageviewer iv-arrow-left"})]),e._v(" "),i("span",{staticClass:"lcy-image-viewer__btn lcy-image-viewer__next",class:{"is-disabled":!e.infinite&&e.isLast},on:{click:e.next}},[i("i",{staticClass:"imageviewer iv-arrow-right"})])],e._v(" "),i("div",{staticClass:"lcy-image-viewer__btn lcy-image-viewer__actions"},[i("div",{staticClass:"lcy-image-viewer__actions__inner"},[i("i",{staticClass:"imageviewer iv-zoom-out",on:{click:function(t){return e.handleActions("zoomOut")}}}),e._v(" "),i("i",{staticClass:"imageviewer iv-zoom-in",on:{click:function(t){return e.handleActions("zoomIn")}}}),e._v(" "),i("i",{staticClass:"lcy-image-viewer__actions__divider"}),e._v(" "),i("i",{class:e.mode.icon,on:{click:e.toggleMode}}),e._v(" "),i("i",{staticClass:"lcy-image-viewer__actions__divider"}),e._v(" "),i("i",{staticClass:"imageviewer iv-refresh-left",on:{click:function(t){return e.handleActions("anticlocelise")}}}),e._v(" "),i("i",{staticClass:"imageviewer iv-refresh-right",on:{click:function(t){return e.handleActions("clocelise")}}})])]),e._v(" "),i("div",{staticClass:"lcy-image-viewer__canvas"},[e._l(e.urlList,(function(t,n){return[n===e.index?i("img",{key:t,ref:"img",refInFor:!0,staticClass:"lcy-image-viewer__img",style:e.imgStyle,attrs:{src:e.currentImg},on:{load:e.handleImgLoad,error:e.handleImgError,mousedown:function(t){return t.stopPropagation(),e.handleMouseDown(t)}}}):e._e()]}))],2)],2)])})).exports;u.install=function(e){e.component(u.name,u)};const m=u},197:t=>{t.exports=e}},i={};function n(e){if(i[e])return i[e].exports;var s=i[e]={exports:{}};return t[e](s,s.exports,n),s.exports}return n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n(196)})().default}));
//# sourceMappingURL=image-viewer.min.js.map